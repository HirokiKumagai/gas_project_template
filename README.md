# GAS + TypeScript + clasp + esbuild Template

これは、Google Apps Script (GAS) のプロジェクトを TypeScript, clasp, esbuild を使って開発するためのテンプレートです。サンプルとして、Google スプレッドシートをデータベースにしたシンプルなタスク管理機能が含まれています。

## 概要

このテンプレートは、モダンな開発環境でGASを効率的に開発することを目指しています。TypeScriptによる型安全なコーディングと、esbuildによる高速なビルド、claspによる簡単なデプロイを実現します。

## 特徴

- **TypeScript**: 静的型付けにより、コードの品質と保守性を向上させます。
- **esbuild**: 高速なバンドラ・コンパイラで、開発サイクルを短縮します。
- **clasp**: Google公式のCLIツールで、ローカルでの開発とデプロイを容易にします。
- **モジュール管理**: `import`/`export` を使用したモダンなモジュールシステムを利用できます。
- **すぐに使える**: タスク管理のサンプルコードが含まれており、すぐに試すことができます。

## ディレクトリ構成

```
.
├── dist/                   # ビルドされたJSファイルが格納される
├── node_modules/           # 依存ライブラリ
├── src/                    # TypeScriptのソースコード
│   ├── TaskManager.ts      # タスク管理のコアロジック
│   ├── main.ts             # GASから呼び出されるメイン関数
│   └── types.ts            # 型定義
├── .clasp.json             # claspの設定ファイル
├── esbuild.js              # esbuildのビルド設定
├── package.json            # プロジェクトの設定と依存関係
└── tsconfig.json           # TypeScriptのコンパイラ設定
```

## セットアップと実行方法

### 1. 事前準備

まず、お使いのコンピュータに [Node.js](https://nodejs.org/) がインストールされていることを確認してください。

次に、ターミナルでこのプロジェクトのルートディレクトリに移動し、以下のコマンドを実行して必要なライブラリをインストールします。

```bash
npm install
```

### 2. Google アカウントへのログイン

`clasp` を通じてGoogleアカウントにログインします。以下のコマンドを実行すると、ブラウザが開き認証を求められます。

```bash
npx clasp login
```

### 3. Google スプレッドシートと GAS プロジェクトの準備

1.  **新しい Google スプレッドシートを作成**
    [Google スプレッドシート](https://sheets.new)にアクセスして、新しいスプレッドシートを作成します。

2.  **GAS プロジェクトを作成し、Script ID をコピー**
    a. スプレッドシートのメニューから `拡張機能` > `Apps Script` を選択します。
    b. GASエディタが開いたら、左側のメニューから歯車アイコンの **プロジェクトの設定** をクリックします。
    c. 「**スクリプト ID**」をコピーします。

### 4. ローカルプロジェクトとの連携

プロジェクトのルートにある `.clasp.json` ファイルを開き、`scriptId` の値を、先ほどコピーしたあなたの **スクリプト ID** に書き換えます。

```json:.clasp.json
{
  "scriptId": "ここにあなたのスクリプトIDを貼り付け",
  "rootDir": "dist"
}
```

### 5. ビルドとデプロイ

以下のコマンドを実行すると、TypeScriptコードがビルドされ、指定したGASプロジェクトにデプロイ（プッシュ）されます。

```bash
npm run deploy
```

### 6. 実行

1.  デプロイが完了したら、GASプロジェクトに紐づいている **Google スプレッドシートを再読み込み** します。
2.  `Tasks` という名前のシートが自動的に作成されていれば成功です。
3.  GASエディタに戻り、実行したい関数（例: `getAllTasks`）を選択して「実行」ボタンを押します。
    - 初回実行時には、スクリプトがスプレッドシートへアクセスするための承認が求められますので、許可してください。

## 利用可能なスクリプト

`package.json` には、以下のスクリプトが定義されています。

-   `npm run build`
    `src` ディレクトリの TypeScript ファイルを `esbuild` を使ってビルドし、`dist` ディレクトリにバンドルされた JavaScript ファイルを生成します。

-   `npm run push`
    `dist` ディレクトリのファイルを `clasp` を使って Google Apps Script プロジェクトにプッシュします。

-   `npm run deploy`
    ビルド (`build`) とプッシュ (`push`) を連続して実行します。

-   `npm run open`
    `clasp` を使って、ブラウザで GAS プロジェクトのエディタを開きます。 